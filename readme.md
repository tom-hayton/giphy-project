# Giphy Project
This is the repository for my Giphy project, creating an app that loads gifs using the Giphy API (https://developers.giphy.com/branch/master/docs/api/endpoint/).

The app is created as per the spec detailed in https://www.figma.com/file/8sc0mqgY6pzzkpAQj9QNCX/GIPHY-Assessment?node-id=243%3A1

# Steps to run

1. Clone the repo to your local machine
2. Install the 'Live Server' extension for VSCode
3. Open the index.html file and click the 'Go Live' button in the bottom-right corner of the screen in VSCode

# Acceptance Criteria

The acceptance criteria for the project is detailed below:

- HTML is valid W3C standard
- CSS class names use BEM
- The CSS is mobile first and responsive
- There is validation for a blank search
- Loading time is considered
- Error handling is considered
- Read me file on steps to run
- Steps required to run the project locally

# Design Philosophy

Due to the light requirements of the app, coupled with my focus on learning to work more closely with Vanilla JS and implement what I have learned in my initial training, the project is written without any frameworks.

This provides a lightweight application that is performant both for initial load and subsequent interactivity.

The design is mobile first, with static html content added for the 'random gif' page only.
As the user browses to the next tabs, the DOM content is created dynamically with JS and appended to the page, while the DOM content of the previous tab is retained, but hidden once it has been created.
For desktop users, the page is still loaded dynamically, but all tabs are loaded upon page load.

# Notable Project Architecture

The project uses Javascript Modules to break up code and dynamically import segments only when required.

Similar functions of each module, such as mounting and unmounting specific sections, are generated using factory functions for compatibility between modules.

# App Considerations

The following sections have been considered and tested throughout the project.

## Responsive Design

The app is mobile first, with root styling created for a mobile design, utilizing responsive style properties such as flex-wrap to dynamically wrap the array of gifs for search results.

media queries are used to detect larger screen sizes, dynamically hiding the mobile navbar at larger screen sizes.

Each section (random, finder and trending) is labelled as a tab for mobile devices via the role attribute.

- Navbar ul element - role = "tablist"
- Navbar list items - role = "tab"
- Section elements - role = "tabpanel"

## Error Handling

Some gifs come with empty title descriptions, which I have used for alt text on images. Each gif loaded is checked for an empty title key, and if it is empty, a generic entry such as "randomized gif from giphy" is substituted.

## Blank Search Validation

The following attributes are added to the form input

- required
- MinLength attribute set to 1
- pattern, matching a string of empty spaces only (manually varified on https://regexr.com/)

Note: The search term is also checked to see if it has changed since the previous search, if not, the api call is not made so the loaded content is retained

## Mobile First

The app is mobile first, with root styling created for a mobile design, with a media query to detect larger screens both in CSS and Javascript, for additive features at those screen sizes.

## Loading Time

### Dynamic Loading
The application is dynamically loaded to reduce initial load times.

For mobile devices, the html content is loaded for the 'random gif' page only. When the user navigates to the different tabs, the respective javascript modules are used to dynamically generate and insert the relevent HTML into the DOM. This only takes place for the initial load of each tab. After that, the DOM content is retained but the display is toggled when navigating between tabs to improve performance and hence reduce subsequent load times.

For desktop users, all modules are loaded together, but html content is still generated by javascript, which should be ok for a more powerful machine than a mobile.

### API Call bundling

API calls that fetch multiple gifs utilize the GIPHY rendition bundling system (https://developers.giphy.com/docs/optional-settings#renditions-on-demand) to reduce bandwidth requirements and latency in data transfer by receiving a less comprehensive, but still adequate, dataset back from the API.

### Lazy Loaded Images

Where multiple images are inserted onto the page (finder & trending tabs), images that are past a certain threshold count are lazy loaded. Keeping the images that are initially visible to the user on load as eager seemingly improves load times for individual gifs.

# Manual Testing

## Slow 3G Network Speed & Browser Caching Disabled - Google Chrome

### Random Gif

When fetching from the random endpoint, use of the "low_bandwidth" bundle provided by GIPHY doesn't include any information that can be used as the alt tag for the gif, so the "clips_grid_picker" budle is used instead, limiting bandwidth requirements, but also providing meta information for the gif. On mobile devices, the "fixed_height_downsampled" image src is used, the size of which is lower than that the "original" gif src, reducing load times. The sampling rate is lower, hence the frame rate is reduced. Given more time, it may be good to detect the user network connection speed through measuring load times for metrics such as FCL or the fetch request to GIPHY itself, and load the gif with a higher sampling rate based on whether the measured load times exceed some threshold.

### Finder Gifs

Using the search term 'foobas', 2 results are returned. The times for each gif to fully load are measured using the chrome dev tools Network tab.
The following metrics are taken as an average of 5 searches conducted when using different image src values 
- fixed_width - fastest: 7.47s (136kb); slowest: 27.03s (1.1Mb), Qualitative variance between searches: very low.
- original - fastest: 16.20s (355kb); slowest: 3.4mins (9.8Mb), Qualitative variance between searches: very low (only fastest time used to assess variance).

A limit on the number of gifs returned for each API call differs depending on if it is a mobile device or not, with the option to load more.

### Trending Gifs

- As per the testing for finder gifs, the fixed_width src parameter is used.
- A limit on the number of gifs returned for each API call differs depending on if it is a mobiole device or not, with the option to load more.

## Lighthouse Performance Testing
Throughout the app creation, I have found that performance scores vary rather a lot depending on the gif's that are loaded. I have managed to get the app to a state where it is scoring consistenly in the high 80's / low 90's for all parameters, with fluctuation in the scores due to different gifs being loaded. To test further I could make api calls to the same gif ID when testing, to evaluate changes made with consistent network data.


### Dynamically Generated 'Finder' and 'Trending' Tabs

'Random' tab content is static HTML, using Javascript to add dynamic functionality. 'Finder' and 'Trending' tabs are created dynamically with Javascript and hidden once mounted (if on mobile), but still exist in the DOM, for speed and usability as search terms persist when switching between tabs after a search.

# Known Issues

- Toggling device toolbar doesn't result in reload or resize events, hence app must be resized or reloaded for tbs to be hidden / revealed / loaded
- 'finder' and 'trending' tabs do not have their own routes, so user must always navigate through homepage ('random' tab), to get to the other tabs
- Chrome reporting "Indicate whether to send a cookie in a cross-site request by specifying its SameSite attribute", this seems to be a server-side issue on GIPHY's end - "https://stackoverflow.com/questions/63273838/why-am-i-getting-indicate-whether-to-send-a-cookie-in-a-cross-site-request-by-s"


# Ways the app could be improved with more time

- Add pause / play control to each gif, with the gif preview loaded as the thumbnail, loading the full gif dynamically when play is pressed
- Make desktop sections collapsable
- Use a screen reader to better evaluate accessibility
- Auto load more gifs on scroll instead of 'load more button'
- Animate loading widget spinner
- Use initial API calls to detect network speed and hence tailor restrictions based on network speed instead of device width
- Device orientation detection
- Greater media query resolution
- Test for consistency accross different browsers
